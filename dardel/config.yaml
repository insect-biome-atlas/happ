# This is the configuration profile for the Dardel HPC system
# Read more about the available partitions at https://www.pdc.kth.se/support/documents/run_jobs/job_scheduling.html#dardel-partitions
# and about the compute nodes at https://www.pdc.kth.se/support/documents/run_jobs/job_scheduling.html#dardel-compute-nodes

# Update <your-slurm-account> under default-resources to your own slurm compute account
default-resources: 
  slurm_account: <your-slurm-account>
  slurm_partition: shared
  runtime: 240
  tasks: f"{threads}"
  cpus_per_task: 1

# The settings below override the default-resources for specific rules
set-resources:
  hmm_align:
    runtime: 5
  raxml_evaluate:
    runtime: 60
    mem_mb: 3552
  epa_ng:
    runtime: 30
    mem_mb: 42624
  gappa_assign:
    runtime: 20
    mem_mb: 3552
  sintax:
    runtime: 30
    mem_mb: 10000
  sum_asvs:
    runtime: 60
    mem_mb: 60000
  chimera_samplewise:
    runtime: 60
    mem_mb: 24000
  vsearch_align:
    mem_mb: 60000
  run_dbotu3:
    runtime: 10080
    slurm_partition: long
    mem_mb: 24000
  mafft_align:
    runtime: 30
    mem_mb: 24000
  pal2nal:
    runtime: 30
  run_opticlust:
    mem_mb: 60000
  split_counts_samplewise:
    runtime: 20
  consensus_taxonomy:
    runtime: 60
  id_spikeins:
    runtime: 120
    mem_mb: 60000
  clean_asvs:
    mem_mb: 60000
  lulu_matchlist_vsearch:
    runtime: 120
  evaluate_order_lulu:
    runtime: 4320
  generate_counts_files:
    runtime: 60
    mem_mb: 60000
  generate_datasets:
    runtime: 60
    mem_mb: 64000
  generate_evodistlists:
    runtime: 60
  generate_neeat_filtered:
    runtime: 2410
    mem_mb: 4000
  order_otutab:
    mem_mb: 64000
  run_swarm:
    runtime: 60
    mem_mb: 60000

set-threads:
  run_swarm: 20
  sum_asvs: 1
  split_counts: 1
  chimera_samplewise: 4
  lulu_matchlist_vsearch: 4
  matchlist_vsearch: 4
  lulu_matchlist_blastn: 4
  generate_datasets: 2

# The settings below define command line flags for snakemake
keep-going: True
printshellcmds: True
rerun-triggers: mtime
rerun-incomplete: True
local-cores: 1
jobs: 100
latency-wait: 5
executor: slurm
use-conda: True
use-apptainer: True
